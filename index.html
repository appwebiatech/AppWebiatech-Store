<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#0b1116"> 
    <title>AppWebiatech Store</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Google+Sans:wght@400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

    <style>
        /* --- UPDATE WARNA SESUAI LOGO APPWEBIATECH --- */
        :root {
            /* TEMA DEFAULT (DARK MODE) */
            --bg-color: #0b1116; 
            --surface-color: #161b22;
            --surface-variant: #21262d;
            --border-color: rgba(255, 255, 255, 0.1);
            
            --brand-blue: #0065ff;
            --brand-green: #8bc34a;
            --brand-orange: #f57c00;
            
            --text-primary: #ffffff;
            --text-secondary: #8b949e;
            --glass-border: rgba(255, 255, 255, 0.1);
            --header-bg: rgba(11, 17, 22, 0.95);
        }

        /* --- TEMA TERANG (LIGHT MODE) --- */
        body.light-mode {
            --bg-color: #ffffff; 
            --surface-color: #f6f8fa;
            --surface-variant: #eaeef2;
            --border-color: #d0d7de;
            
            --text-primary: #24292f;
            --text-secondary: #57606a;
            --glass-border: rgba(0, 0, 0, 0.1);
            --header-bg: rgba(255, 255, 255, 0.95);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Roboto', sans-serif; -webkit-tap-highlight-color: transparent; user-select: none; }
        input, textarea { user-select: text; }
        body { background-color: var(--bg-color); color: var(--text-primary); padding-bottom: 90px; overflow-x: hidden; min-height: 100vh; min-height: 100dvh; transition: background-color 0.3s, color 0.3s; }

        header {
            position: fixed; top: 0; left: 0; width: 100%;
            background: var(--header-bg); 
            backdrop-filter: blur(10px);
            z-index: 1000;
            padding: 10px 20px; /* Sedikit disesuaikan paddingnya */
            border-bottom: 1px solid var(--glass-border);
            display: flex; align-items: center; gap: 15px;
            height: 70px;
        }
        
        /* --- PERUBAHAN MENU BTN MENJADI BULAT --- */
        .menu-btn {
            font-size: 1.2rem; 
            color: var(--text-primary); 
            cursor: pointer;
            
            /* Style Bulat */
            width: 40px; 
            height: 40px;
            border-radius: 50%; /* Ini yang bikin bulat */
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        /* Efek saat disentuh agar terlihat bulatnya */
        .menu-btn:active { 
            background: rgba(128, 128, 128, 0.2); 
        }

        .search-bar {
            flex-grow: 1; background: var(--surface-variant); height: 45px;
            border-radius: 25px; display: flex; align-items: center; padding: 0 20px;
            color: var(--text-secondary); border: 1px solid var(--glass-border);
            transition: background 0.3s;
        }
        .search-bar:focus-within { border-color: var(--brand-blue); }
        .search-bar input { background: transparent; border: none; outline: none; color: var(--text-primary); width: 100%; margin-left: 10px; }
        
        .clock-widget { text-align: right; font-size: 0.8rem; line-height: 1.2; min-width: 50px; }
        .clock-time { color: var(--brand-green); font-weight: bold; font-family: 'Google Sans'; font-size: 1rem; }

        /* --- SIDEBAR & OVERLAY --- */
        .sidebar-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.5); z-index: 1900;
            opacity: 0; visibility: hidden; transition: 0.3s;
        }
        .sidebar-overlay.active { opacity: 1; visibility: visible; }

        .sidebar {
            position: fixed; top: 0; left: -280px; width: 280px; height: 100%;
            background: var(--surface-color); z-index: 2000;
            transition: left 0.3s ease; padding: 20px;
            border-right: 1px solid var(--glass-border);
            display: flex; flex-direction: column;
        }
        .sidebar.active { left: 0; }

        .sidebar-header {
            font-family: 'Google Sans'; font-size: 1.3rem; font-weight: bold;
            color: var(--brand-blue); margin-bottom: 30px; display: flex; align-items: center; gap: 10px;
        }

        /* --- STYLE BARU UNTUK LOGO GAMBAR --- */
        .sidebar-logo-img {
            height: 30px; /* Atur tinggi logo di sini */
            width: auto;  /* Lebar menyesuaikan */
            object-fit: contain;
        }

        .sidebar-item {
            display: flex; align-items: center; gap: 15px;
            padding: 15px; border-radius: 10px; color: var(--text-primary);
            cursor: pointer; transition: 0.2s; font-weight: 500;
        }
        .sidebar-item:active { background: var(--surface-variant); }
        .sidebar-item i { width: 20px; text-align: center; color: var(--text-secondary); }
        
        /* Toggle Switch */
        .toggle-switch {
            width: 40px; height: 20px; background: #555; border-radius: 20px;
            position: relative; margin-left: auto; transition: 0.3s;
        }
        .toggle-switch::after {
            content: ''; position: absolute; top: 2px; left: 2px;
            width: 16px; height: 16px; background: white; border-radius: 50%;
            transition: 0.3s;
        }
        body.light-mode .toggle-switch { background: var(--brand-blue); }
        body.light-mode .toggle-switch::after { left: 22px; }

        /* General Styles */
        .page-container { margin-top: 80px; display: none; padding: 20px; animation: fadeIn 0.3s; }
        .page-container.active { display: block; }

        .filter-scroll { display: flex; gap: 10px; overflow-x: auto; margin-bottom: 20px; padding-bottom: 5px; scrollbar-width: none; }
        .filter-scroll::-webkit-scrollbar { display: none; }
        
        .chip {
            padding: 8px 16px; border-radius: 20px; font-size: 0.85rem; white-space: nowrap;
            border: 1px solid var(--glass-border); background: var(--surface-variant); color: var(--text-secondary);
            cursor: pointer; transition: 0.3s;
        }
        .chip.active { 
            background: rgba(0, 101, 255, 0.15);
            color: var(--brand-blue); 
            border-color: var(--brand-blue); 
        }

        .app-item { display: flex; align-items: center; gap: 15px; margin-bottom: 25px; cursor: pointer; }
        .app-item:active { opacity: 0.7; }
        .app-icon { width: 65px; height: 65px; border-radius: 15px; object-fit: cover; background: #333; transition: transform 0.2s; box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        .app-details { flex-grow: 1; }
        .app-name { font-size: 1rem; font-weight: 500; color: var(--text-primary); }
        .app-meta { font-size: 0.85rem; color: var(--text-secondary); margin-top: 2px;}
        
        .install-btn {
            padding: 0 20px; height: 36px; border-radius: 18px;
            border: 1px solid var(--glass-border); background: transparent;
            color: var(--brand-blue); font-weight: 600; font-size: 0.85rem;
            cursor: pointer; display: flex; align-items: center; justify-content: center;
        }
        .install-btn.premium { color: var(--brand-orange); border-color: rgba(245, 124, 0, 0.4); }
        .install-btn.loading::after {
            content: ''; width: 16px; height: 16px; border: 2px solid var(--brand-blue);
            border-top-color: transparent; border-radius: 50%; animation: spin 0.8s infinite;
        }
        .install-btn.open { background: var(--surface-variant); color: var(--text-secondary); border: none; }

        .app-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: var(--bg-color); z-index: 2000; overflow-y: auto;
            transform: translateY(100%); transition: transform 0.3s cubic-bezier(0,0,0.2,1);
            padding-bottom: 100px;
        }
        .app-modal.show { transform: translateY(0); }
        
        .modal-header { padding: 20px; display: flex; gap: 20px; align-items: center; border-bottom: 1px solid var(--glass-border); background: var(--surface-color); color: var(--text-primary); }
        .modal-back { font-size: 1.5rem; color: var(--text-primary); background: none; border: none; cursor: pointer; }
        
        .modal-content { padding: 20px; }
        .modal-section { margin-bottom: 30px; }
        .modal-title { font-family: 'Google Sans'; font-size: 1.2rem; margin-bottom: 10px; color: var(--text-primary); border-left: 3px solid var(--brand-green); padding-left: 10px; }
        .modal-text { font-size: 0.9rem; color: var(--text-secondary); line-height: 1.6; }
        
        .info-row { display: flex; justify-content: space-between; padding: 15px 0; border-bottom: 1px solid var(--glass-border); }
        .info-label { color: var(--text-secondary); font-size: 0.9rem; }
        .info-value { color: var(--text-primary); font-size: 0.9rem; font-weight: 500; }
        
        .contact-link { display: flex; align-items: center; gap: 10px; color: var(--brand-blue); text-decoration: none; margin-top: 10px; font-size: 0.95rem; }

        .book-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px, 1fr)); gap: 15px; }
        .book-card { display: flex; flex-direction: column; gap: 8px; cursor: pointer; }
        .book-cover { 
            width: 100%; aspect-ratio: 2/3; background: #333; border-radius: 8px; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.3); object-fit: cover;
        }
        .book-title { font-size: 0.85rem; font-weight: 500; color: var(--text-primary); display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }

        #toast {
            visibility: hidden; min-width: 250px; background-color: var(--surface-variant); color: var(--text-primary); text-align: center;
            border-radius: 50px; padding: 12px 24px; position: fixed; z-index: 3000; left: 50%; bottom: 100px;
            transform: translateX(-50%); box-shadow: 0 4px 15px rgba(0,0,0,0.5); font-size: 0.9rem;
            border: 1px solid var(--glass-border);
        }
        #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }

        .bottom-nav {
            position: fixed; bottom: 0; left: 0; width: 100%; background: var(--surface-color);
            border-top: 1px solid var(--glass-border); height: 70px;
            display: flex; justify-content: space-around; align-items: center; z-index: 1500;
        }
        .nav-item {
            display: flex; flex-direction: column; align-items: center; gap: 5px;
            color: var(--text-secondary); font-size: 0.75rem; cursor: pointer; flex: 1;
        }
        .nav-item i { font-size: 1.4rem; margin-bottom: 2px; }
        .nav-item.active { color: var(--brand-blue); }
        .nav-item.active i { color: var(--brand-green); }
        
        .review-card { background: var(--surface-variant); padding: 15px; border-radius: 10px; margin-bottom: 10px; border:1px solid var(--glass-border); }
        .review-header { display: flex; justify-content: space-between; margin-bottom: 5px; }
        .reviewer-name { font-weight: bold; font-size: 0.9rem; color: var(--brand-blue); }
        .review-date { font-size: 0.7rem; color: var(--text-secondary); }
        .review-stars { color: var(--brand-orange); font-size: 0.8rem; margin-bottom: 8px; }
        .review-text { font-size: 0.85rem; line-height: 1.4; color: var(--text-primary); }
        
        .write-review-btn { width: 100%; padding: 12px; background: transparent; border: 1px solid var(--brand-blue); color: var(--brand-blue); border-radius: 8px; margin-bottom: 15px; font-weight: bold; cursor: pointer; }
        .review-form-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2500; display: none; align-items: center; justify-content: center; padding: 20px; }
        .review-form-box { background: var(--surface-color); width: 100%; max-width: 400px; padding: 20px; border-radius: 15px; border: 1px solid var(--glass-border); }
        .star-input { display: flex; justify-content: center; gap: 10px; margin: 20px 0; }
        .star-input i { font-size: 2rem; color: var(--text-secondary); cursor: pointer; transition: 0.2s; }
        .star-input i.active { color: var(--brand-orange); }
        .form-input { width: 100%; padding: 12px; background: var(--bg-color); border: 1px solid var(--glass-border); color: var(--text-primary); border-radius: 8px; margin-bottom: 10px; }
        
        .hidden { display: none !important; }
        @keyframes spin { 100% { transform: rotate(360deg); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 100px; opacity: 1;} }
        @keyframes fadeout { from {bottom: 100px; opacity: 1;} to {bottom: 0; opacity: 0;} }
    </style>
</head>
<body oncontextmenu="return false;">

    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="appwebiatecth.jpg" alt="" class="sidebar-logo-img">
            AppWebiatech
        </div>
        
        <div class="sidebar-item" onclick="toggleTheme()">
            <i class="fas fa-moon"></i>
            <span>Mode Terang</span>
            <div class="toggle-switch"></div>
        </div>

        <div class="sidebar-item" onclick="openPrivacyPolicy()">
            <i class="fas fa-user-shield"></i>
            <span>Kebijakan Privasi</span>
        </div>

        <div class="sidebar-item" onclick="downloadStoreApp()">
            <i class="fas fa-download"></i>
            <span>Unduh Aplikasi Ini</span>
        </div>

        <div class="sidebar-item" style="margin-top:auto; border-top:1px solid var(--glass-border); color:var(--text-secondary);" onclick="toggleSidebar()">
            <i class="fas fa-chevron-left"></i>
            <span>Tutup Menu</span>
        </div>
    </div>

    <div id="privacyModal" class="app-modal">
        <div class="modal-header">
            <button class="modal-back" onclick="closePrivacyPolicy()"><i class="fas fa-arrow-left"></i></button>
            <div style="font-weight:bold; font-size:1.1rem;">Kebijakan Privasi</div>
        </div>
        <div class="modal-content">
            <div class="modal-section">
                <div class="modal-title">Perlindungan Data Anda</div>
                <p class="modal-text">
                    AppWebiatech berkomitmen untuk melindungi privasi Anda. Aplikasi ini dirancang untuk memberikan pengalaman pengguna yang aman dan nyaman.
                    <br><br>
                    <strong>1. Pengumpulan Data</strong><br>
                    Kami tidak mengumpulkan data pribadi sensitif tanpa izin Anda. Data seperti ulasan atau rating disimpan menggunakan Firebase untuk keperluan tampilan aplikasi.
                    <br><br>
                    <strong>2. Izin Aplikasi</strong><br>
                    Beberapa aplikasi yang didownload dari toko ini mungkin memerlukan izin (seperti Lokasi atau Wifi) agar berfungsi dengan baik, namun toko aplikasi ini sendiri hanya memerlukan akses internet.
                    <br><br>
                    <strong>3. Keamanan</strong><br>
                    Kami menggunakan enkripsi standar untuk melindungi komunikasi antara perangkat Anda dan server kami.
                </p>
            </div>
        </div>
    </div>

    <header>
        <div class="menu-btn" onclick="toggleSidebar()">
            <i class="fas fa-bars"></i>
        </div>

        <div class="search-bar">
            <i class="fas fa-search"></i>
            <input type="text" id="searchInput" placeholder="Telusuri aplikasi & buku...">
        </div>
        <div class="clock-widget">
            <div class="clock-time" id="clockTime">00:00</div>
            <div style="color: var(--text-secondary); font-size: 0.7rem;" id="clockDate">Sen, 1 Jan</div>
        </div>
    </header>

    <main id="page-apps" class="page-container active">
        
        <div class="filter-scroll">
            <div class="chip active" onclick="filterApps('all', this)">Untuk Anda</div>
            <div class="chip" onclick="filterApps('popular', this)">Paling Populer</div>
            <div class="chip" onclick="filterApps('productivity', this)">Produktivitas</div>
            <div class="chip" onclick="filterApps('premium', this)">Pilihan Premium</div>
        </div>

        <h3 style="margin-bottom: 20px; font-family:'Google Sans'; color:var(--brand-blue);">Aplikasi Disarankan</h3>
        
        <div id="appList"></div>

        <div id="emptySearch" class="hidden" style="text-align:center; margin-top:50px; color:var(--text-secondary);">
            <i class="fas fa-search" style="font-size:2rem; margin-bottom:10px; opacity:0.5;"></i>
            <p>Aplikasi tidak ditemukan.</p>
        </div>

    </main>

    <main id="page-offers" class="page-container">
        <h2 style="font-family:'Google Sans'; margin-bottom:10px; color: var(--brand-orange);">Penawaran & Promo</h2>
        <p style="color:var(--text-secondary); font-size:0.9rem; margin-bottom:20px;">Diskon spesial untuk aplikasi premium.</p>

        <div style="background: linear-gradient(135deg, var(--brand-blue), var(--brand-green)); padding: 20px; border-radius: 12px; color: white; margin-bottom: 25px;">
            <h3 style="margin-bottom: 5px;">Wifi Monitor Pro ID</h3>
            <p style="font-size:0.9rem; margin-bottom:15px; color:#f0f0f0;">Amankan jaringan WiFi Anda dari pencuri. Diskon 50%!</p>
            <a href="https://wa.me/6281275623551?text=Saya%20mau%20promo%20Wifi%20Monitor" target="_blank" style="background:white; color:var(--brand-blue); padding:8px 16px; border-radius:20px; text-decoration:none; font-size:0.85rem; font-weight:bold;">Klaim Sekarang</a>
        </div>

        <div style="background: var(--surface-variant); padding: 20px; border-radius: 12px; border: 1px solid var(--glass-border);">
            <h3 style="font-size:1.1rem; margin-bottom:15px;"><i class="fas fa-gift" style="color:var(--brand-orange)"></i> Tukarkan Kode</h3>
            <input type="text" id="promoInput" placeholder="Masukkan kode voucher..." style="width:100%; padding:12px; background:var(--bg-color); border:1px solid var(--glass-border); color:var(--text-primary); border-radius:8px; margin-bottom:10px; font-family:monospace; text-transform:uppercase;">
            <button onclick="checkPromo()" style="width:100%; padding:10px; background:var(--brand-blue); color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer;">Tukarkan</button>
            <div id="promoMsg" style="margin-top:10px; font-size:0.85rem;"></div>
            
            <div id="hiddenDownload" class="hidden" style="margin-top:15px; padding-top:15px; border-top:1px solid var(--glass-border);">
                <button class="install-btn" style="width:100%; border-color:var(--brand-blue); background:rgba(0,101,255,0.1);" onclick="window.location.href='#'">Download Premium</button>
            </div>
        </div>
    </main>

    <main id="page-books" class="page-container">
        <h2 style="font-family:'Google Sans'; margin-bottom:20px; color:var(--brand-green);">Buku & Referensi</h2>
        <div class="filter-scroll">
            <div class="chip active">E-Book</div>
            <div class="chip">Audiobook</div>
            <div class="chip">Komik</div>
        </div>
        <div class="book-grid">
            <div class="book-card" onclick="showToast('Fitur baca online segera hadir!')">
                <div class="book-cover" style="background:linear-gradient(to bottom, #0065ff, #8bc34a); display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; text-align:center; padding:5px;">Panduan Sholat</div>
                <div class="book-title">Panduan Sholat Lengkap</div>
                <div style="font-size:0.75rem; color:var(--text-secondary);">Gratis</div>
            </div>
            <div class="book-card" onclick="showToast('Fitur baca online segera hadir!')">
                <div class="book-cover" style="background:linear-gradient(to bottom, #8bc34a, #f57c00); display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; text-align:center; padding:5px;">Kisah 25 Nabi</div>
                <div class="book-title">Sejarah 25 Nabi & Rasul</div>
                <div style="font-size:0.75rem; color:var(--text-secondary);">Gratis</div>
            </div>
            <div class="book-card" onclick="showToast('Fitur baca online segera hadir!')">
                <div class="book-cover" style="background:linear-gradient(to bottom, #f57c00, #fee140); display:flex; align-items:center; justify-content:center; color:white; font-weight:bold; text-align:center; padding:5px;">Doa Harian</div>
                <div class="book-title">Kumpulan Doa Harian</div>
                <div style="font-size:0.75rem; color:var(--text-secondary);">Gratis</div>
            </div>
        </div>
    </main>

    <div id="appDetailModal" class="app-modal">
        <div class="modal-header">
            <button class="modal-back" onclick="closeDetail()"><i class="fas fa-arrow-left"></i></button>
            <div style="font-weight:bold; font-size:1.1rem;">Detail Aplikasi</div>
            <div style="flex-grow:1;"></div>
            <i class="fas fa-search" style="font-size:1.2rem;"></i>
        </div>

        <div class="modal-content">
            <div style="display:flex; gap:20px; margin-bottom:30px;">
                <img id="detailIcon" src="" style="width:80px; height:80px; border-radius:20px; background:#333; object-fit:cover;">
                <div style="flex-grow:1;">
                    <h2 id="detailTitle" style="font-family:'Google Sans'; font-size:1.5rem; margin-bottom:5px;">App Name</h2>
                    <div style="color:var(--brand-green); font-size:0.9rem; margin-bottom:10px;">AppWebiatech Inc.</div>
                    <button id="detailInstallBtn" class="install-btn" style="width:100%; background:var(--brand-blue); color:white; border:none;">Install</button>
                </div>
            </div>

            <div style="display:flex; justify-content:space-around; margin-bottom:30px; border-bottom:1px solid var(--glass-border); padding-bottom:20px;">
                <div style="text-align:center;">
                    <div style="font-weight:bold;" id="detailAvgRating">0.0 <i class="fas fa-star" style="font-size:0.7rem; color:var(--brand-orange)"></i></div>
                    <div style="font-size:0.75rem; color:var(--text-secondary);">Ulasan</div>
                </div>
                <div style="text-align:center; border-left:1px solid var(--glass-border); border-right:1px solid var(--glass-border); padding:0 20px;">
                    <div id="detailDownloadCount" style="font-weight:bold;">100+</div>
                    <div style="font-size:0.75rem; color:var(--text-secondary);">Download</div>
                </div>
                <div style="text-align:center;">
                    <div style="font-weight:bold;">3+</div>
                    <div style="font-size:0.75rem; color:var(--text-secondary);">Rating</div>
                </div>
            </div>

            <div class="modal-section">
                <div class="modal-title">Ulasan & Rating</div>
                <button class="write-review-btn" onclick="openReviewForm()">Tulis Ulasan</button>
                <div id="reviewsContainer">
                    <div style="color:var(--text-secondary); text-align:center; font-size:0.85rem;">Belum ada ulasan.</div>
                </div>
            </div>

            <div class="modal-section">
                <div class="modal-title">Tentang aplikasi ini</div>
                <p id="detailDesc" class="modal-text">Deskripsi lengkap aplikasi akan muncul di sini.</p>
                <div style="display:flex; gap:10px; margin-top:15px; overflow-x:auto;">
                    <div style="background:var(--surface-variant); padding:5px 10px; border-radius:5px; font-size:0.75rem; color:var(--brand-green);">Keuangan</div>
                    <div style="background:var(--surface-variant); padding:5px 10px; border-radius:5px; font-size:0.75rem; color:var(--brand-green);">Produktivitas</div>
                </div>
            </div>

            <div class="modal-section">
                <div class="modal-title">Dukungan Aplikasi</div>
                <div class="info-row">
                    <span class="info-label">Versi</span>
                    <span class="info-value">1.0.2</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Diupdate pada</span>
                    <span class="info-value">Des 2024</span>
                </div>
                <div style="margin-top:15px;">
                    <a href="#" id="detailEmail" class="contact-link"><i class="far fa-envelope"></i> email@example.com</a>
                </div>
            </div>

            <div class="modal-section">
                <div class="modal-title">Kebijakan Privasi</div>
                <div style="background:var(--surface-variant); padding:15px; border-radius:10px; border:1px solid var(--glass-border);">
                    <p id="detailPolicy" style="font-size:0.8rem; color:var(--text-secondary);">
                        Aplikasi ini menghormati privasi Anda.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <div id="reviewFormOverlay" class="review-form-overlay">
        <div class="review-form-box">
            <h3 style="font-family:'Google Sans'; margin-bottom:5px;">Beri Rating</h3>
            <p style="font-size:0.8rem; color:var(--text-secondary);">Bagaimana pengalaman Anda?</p>
            
            <div class="star-input" id="starInputContainer">
                <i class="far fa-star" onclick="setStar(1)"></i>
                <i class="far fa-star" onclick="setStar(2)"></i>
                <i class="far fa-star" onclick="setStar(3)"></i>
                <i class="far fa-star" onclick="setStar(4)"></i>
                <i class="far fa-star" onclick="setStar(5)"></i>
            </div>

            <input type="text" id="reviewName" class="form-input" placeholder="Nama Anda (Opsional)">
            <textarea id="reviewText" class="form-input" rows="3" placeholder="Tulis pengalaman Anda..."></textarea>

            <div style="display:flex; gap:10px; margin-top:10px;">
                <button onclick="closeReviewForm()" style="flex:1; padding:10px; background:transparent; border:1px solid #555; color:var(--text-primary); border-radius:8px;">Batal</button>
                <button onclick="submitReview()" style="flex:1; padding:10px; background:var(--brand-blue); border:none; color:white; border-radius:8px; font-weight:bold;">Kirim</button>
            </div>
        </div>
    </div>

    <div id="toast">Pesan Notifikasi</div>

    <nav class="bottom-nav">
        <div class="nav-item active" id="nav-apps" onclick="switchPage('apps', this)">
            <i class="fas fa-gamepad"></i>
            <span>Apps</span>
        </div>
        <div class="nav-item" id="nav-offers" onclick="switchPage('offers', this)">
            <i class="fas fa-tags"></i>
            <span>Offers</span>
        </div>
        <div class="nav-item" id="nav-books" onclick="switchPage('books', this)">
            <i class="fas fa-book"></i>
            <span>Books</span>
        </div>
    </nav>

    <script>
        // --- KONFIGURASI FIREBASE ---
        // GANTI BAGIAN INI DENGAN DATA DARI FIREBASE CONSOLE ANDA
        const firebaseConfig = {
            apiKey: "API_KEY_ANDA_DISINI",
            authDomain: "PROJECT_ID.firebaseapp.com",
            projectId: "PROJECT_ID_ANDA",
            storageBucket: "PROJECT_ID.appspot.com",
            messagingSenderId: "SENDER_ID",
            appId: "APP_ID"
        };

        // Inisialisasi Firebase
        let db;
        try {
            firebase.initializeApp(firebaseConfig);
            db = firebase.firestore();
            console.log("Firebase Connected");
        } catch (error) {
            console.error("Firebase Error (Belum disetting):", error);
        }

        // --- LOGIKA BARU: SIDEBAR & THEME ---
        
        // 1. Sidebar Logic
        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('active');
            document.getElementById('sidebarOverlay').classList.toggle('active');
        }

        // 2. Theme / Mode Malam & Terang
        function toggleTheme() {
            document.body.classList.toggle('light-mode');
            const isLight = document.body.classList.contains('light-mode');
            localStorage.setItem('theme', isLight ? 'light' : 'dark');
        }

        // Load Theme saat pertama buka
        window.addEventListener('DOMContentLoaded', () => {
            const savedTheme = localStorage.getItem('theme');
            if(savedTheme === 'light') {
                document.body.classList.add('light-mode');
            }
        });

        // 3. Privacy Policy Logic
        function openPrivacyPolicy() {
            toggleSidebar(); // Tutup sidebar dulu
            document.getElementById('privacyModal').classList.add('show');
            history.pushState({modal: true}, null, "");
        }
        
        function closePrivacyPolicy() {
            document.getElementById('privacyModal').classList.remove('show');
        }

        // 4. LOGIKA UNDUH APLIKASI STORE (TERHUBUNG KE LINK EKSTERNAL)
        function downloadStoreApp() {
            toggleSidebar(); // Tutup menu
            
            // --- GANTI LINK DI BAWAH INI DENGAN LINK MEDIAFIRE ANDA ---
            const storeLink = "LINK_MEDIAFIRE_ANDA_DISINI"; 
            
            if(storeLink === "LINK_MEDIAFIRE_ANDA_DISINI") {
                showToast("Link belum diatur di kode program.");
                return;
            }

            showToast("Membuka halaman download...");
            
            setTimeout(() => {
                window.open(storeLink, '_blank'); 
            }, 800);
        }

        // --- DATA APLIKASI (LAMA) ---
        const appDB = {
            'zikirnur': {
                id: 'zikirnur',
                title: 'ZikirNur',
                icon: 'ZikirNur.jpg',
                desc: 'Aplikasi Islami terlengkap untuk menemani ibadah harian Anda.',
                email: 'support@zikirnur.com',
                policy: 'Hanya menggunakan lokasi untuk jadwal sholat.',
                link: 'https://mediafire.com/file/3mfxhg5j6w0a8b7',
                tags: ['popular', 'lifestyle'],
                defaultDownloads: 0, 
                btnText: 'Install',
                isPremium: false
            },
            'kalkulator': {
                id: 'kalkulator',
                title: 'Kalkulator Pintar',
                icon: 'Kalkulator.png',
                desc: 'Alat bantu hitung serbaguna untuk pelajar dan profesional.',
                email: 'tools@appwebiatech.com',
                policy: 'Bekerja offline, tanpa tracking.',
                link: 'https://mediafire.com/file/84gzenmyza0w4d3',
                tags: ['popular', 'productivity'],
                defaultDownloads: 0, 
                btnText: 'Install',
                isPremium: false
            },
            'smartdkm': {
                id: 'smartdkm',
                title: 'Smart DKM',
                icon: 'SmartDKM.png',
                desc: 'Sistem Manajemen Masjid berbasis Web & Android.',
                email: 'dkm@appwebiatech.com',
                policy: 'Data keuangan aman di server Firebase.',
                link: 'https://mediafire.com/file/lq9jc3feplrfqvl',
                tags: ['productivity'],
                defaultDownloads: 0, 
                btnText: 'Install',
                isPremium: false
            },
            'wifimonitor': {
                id: 'wifimonitor',
                title: 'Wifi Monitor Pro ID',
                icon: 'WifiMonitorPro.jpg',
                desc: 'Versi Premium. Pantau pencuri bandwidth.',
                email: 'premium@appwebiatech.com',
                policy: 'Memerlukan lokasi untuk scan SSID.',
                link: '#', 
                tags: ['premium', 'productivity'],
                defaultDownloads: 0, 
                btnText: 'Beli',
                isPremium: true
            }
        };

        let currentAppId = null;
        let currentRating = 0;

        // --- HELPER: Mengambil Jumlah Download ---
        function getDownloads(appId) {
            const stored = localStorage.getItem('dl_' + appId);
            return stored ? parseInt(stored) : appDB[appId].defaultDownloads;
        }

        function formatCount(num) {
            if (num >= 1000) return (num / 1000).toFixed(1) + 'k+';
            return num + ' Download';
        }

        // --- 1. RENDER APPS OTOMATIS ---
        function renderApps(filterCategory) {
            const listContainer = document.getElementById('appList');
            listContainer.innerHTML = ''; 

            for (let key in appDB) {
                const app = appDB[key];
                
                if (filterCategory === 'all' || app.tags.includes(filterCategory)) {
                    
                    const iconStyle = app.isPremium ? 'border:2px solid var(--brand-orange);' : '';
                    const titleStyle = app.isPremium ? 'color:var(--brand-orange);' : '';
                    const btnClass = app.isPremium ? 'install-btn premium' : 'install-btn';
                    
                    const currentDl = getDownloads(app.id);
                    const metaText = `AppWebiatech • ${formatCount(currentDl)}`;

                    const btnClick = app.isPremium 
                        ? `event.stopPropagation(); switchPage('offers', document.getElementById('nav-offers'))`
                        : `event.stopPropagation(); startInstall(this, '${app.link}', '${app.id}')`;

                    const itemHTML = `
                        <div class="app-item" onclick="openDetail('${app.id}')">
                            <img src="${app.icon}" onerror="this.src='https://ui-avatars.com/api/?name=${app.title}&background=random&color=fff'" class="app-icon" style="${iconStyle}">
                            <div class="app-details">
                                <div class="app-name" style="${titleStyle}">${app.title}</div>
                                <div class="app-meta" id="meta-${app.id}">${metaText}</div>
                            </div>
                            <button class="${btnClass}" onclick="${btnClick}">${app.btnText}</button>
                        </div>
                    `;
                    
                    listContainer.innerHTML += itemHTML;
                }
            }
        }

        renderApps('all');

        // --- 2. FITUR PENCARIAN ---
        document.getElementById('searchInput').addEventListener('input', function(e) {
            const keyword = e.target.value.toLowerCase();
            const items = document.querySelectorAll('.app-item');
            let hasResult = false;
            items.forEach(item => {
                const appName = item.querySelector('.app-name').innerText.toLowerCase();
                if (appName.includes(keyword)) {
                    item.style.display = 'flex'; hasResult = true;
                } else {
                    item.style.display = 'none';
                }
            });
            document.getElementById('emptySearch').classList.toggle('hidden', hasResult);
        });

        // --- 3. FILTER LOGIC ---
        function filterApps(category, chipEl) {
            document.querySelectorAll('.chip').forEach(c => c.classList.remove('active'));
            chipEl.classList.add('active');
            renderApps(category);
            document.getElementById('searchInput').value = '';
        }

        // --- 4. TOAST NOTIFICATION ---
        function showToast(message) {
            const toast = document.getElementById("toast");
            toast.innerText = message;
            toast.className = "show";
            setTimeout(function(){ toast.className = toast.className.replace("show", ""); }, 3000);
        }

        // --- JAM DIGITAL ---
        setInterval(() => {
            const now = new Date();
            document.getElementById('clockTime').innerText = now.toLocaleTimeString('id-ID', {hour:'2-digit', minute:'2-digit'});
            document.getElementById('clockDate').innerText = now.toLocaleDateString('id-ID', {weekday:'short', day:'numeric', month:'short'});
        }, 1000);

        // --- NAVIGASI ---
        function switchPage(pageId, navEl) {
            document.querySelectorAll('.page-container').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');
            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            if(navEl) navEl.classList.add('active');
            window.scrollTo(0,0);
        }

        // --- DETAIL APP MODAL ---
        function openDetail(appKey) {
            const data = appDB[appKey];
            if(!data) return;

            currentAppId = appKey; // Simpan ID aplikasi yang sedang dibuka
            
            document.getElementById('detailTitle').innerText = data.title;
            document.getElementById('detailIcon').src = data.icon;
            document.getElementById('detailDesc').innerText = data.desc;
            document.getElementById('detailEmail').innerHTML = '<i class="far fa-envelope"></i> ' + data.email;
            document.getElementById('detailEmail').href = 'mailto:' + data.email;
            document.getElementById('detailPolicy').innerText = data.policy;
            
            const currentDl = getDownloads(data.id);
            document.getElementById('detailDownloadCount').innerText = currentDl + '+';

            const btn = document.getElementById('detailInstallBtn');
            btn.onclick = function() { startInstall(this, data.link, data.id); };
            
            if (data.isPremium) {
                btn.innerText = 'Beli (Rp 500rb)';
                btn.classList.add('premium');
            } else {
                btn.innerText = data.btnText;
                btn.classList.remove('premium');
            }

            // LOAD REVIEWS DARI FIRESTORE
            loadReviews(appKey);

            document.getElementById('appDetailModal').classList.add('show');
            history.pushState({modal: true}, null, "");
        }

        function closeDetail() {
            document.getElementById('appDetailModal').classList.remove('show');
        }

        window.onpopstate = function(event) {
            if (document.getElementById('appDetailModal').classList.contains('show')) closeDetail();
            // Close Privacy Modal if open
            if (document.getElementById('privacyModal').classList.contains('show')) closePrivacyPolicy();
        };

        // --- LOGIK REVIEW & FIRESTORE ---

        function openReviewForm() {
            document.getElementById('reviewFormOverlay').style.display = 'flex';
            currentRating = 0;
            updateStarsUI(0);
            document.getElementById('reviewName').value = '';
            document.getElementById('reviewText').value = '';
        }

        function closeReviewForm() {
            document.getElementById('reviewFormOverlay').style.display = 'none';
        }

        function setStar(n) {
            currentRating = n;
            updateStarsUI(n);
        }

        function updateStarsUI(n) {
            const stars = document.querySelectorAll('#starInputContainer i');
            stars.forEach((star, index) => {
                if(index < n) {
                    star.classList.add('active');
                    star.classList.replace('far', 'fas');
                } else {
                    star.classList.remove('active');
                    star.classList.replace('fas', 'far');
                }
            });
        }

        function submitReview() {
            if(!db) { showToast("Error: Database belum dikonfigurasi!"); return; }
            if(currentRating === 0) { showToast("Silakan pilih bintang rating!"); return; }
            
            const name = document.getElementById('reviewName').value || 'Anonim';
            const text = document.getElementById('reviewText').value;

            // Simpan ke Firestore
            db.collection('reviews').add({
                appId: currentAppId,
                name: name,
                rating: currentRating,
                text: text,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                showToast("Ulasan terkirim!");
                closeReviewForm();
                loadReviews(currentAppId); // Reload ulasan
            }).catch((error) => {
                console.error("Error writing document: ", error);
                showToast("Gagal mengirim ulasan.");
            });
        }

        function loadReviews(appId) {
            if(!db) {
                document.getElementById('reviewsContainer').innerHTML = "<div style='text-align:center; padding:10px;'>Database offline (Config belum diisi).</div>";
                return;
            }

            const container = document.getElementById('reviewsContainer');
            container.innerHTML = "<div style='text-align:center; padding:10px;'>Memuat ulasan...</div>";

            db.collection('reviews')
              .where("appId", "==", appId)
              .orderBy("timestamp", "desc")
              .limit(10)
              .get()
              .then((querySnapshot) => {
                  container.innerHTML = "";
                  let totalRating = 0;
                  let count = 0;

                  if(querySnapshot.empty) {
                      container.innerHTML = "<div style='color:var(--text-secondary); text-align:center; font-size:0.85rem; padding:10px;'>Belum ada ulasan. Jadilah yang pertama!</div>";
                      document.getElementById('detailAvgRating').innerHTML = `0.0 <i class="fas fa-star" style="font-size:0.7rem; color:var(--brand-orange)"></i>`;
                      return;
                  }

                  querySnapshot.forEach((doc) => {
                      const data = doc.data();
                      totalRating += data.rating;
                      count++;

                      // Generate Star string
                      let starsHTML = "";
                      for(let i=1; i<=5; i++) {
                          if(i <= data.rating) starsHTML += '<i class="fas fa-star"></i>';
                          else starsHTML += '<i class="far fa-star"></i>';
                      }

                      // Format tanggal simple
                      let dateStr = "";
                      if(data.timestamp) {
                          const date = data.timestamp.toDate();
                          dateStr = date.toLocaleDateString();
                      }

                      const html = `
                        <div class="review-card">
                            <div class="review-header">
                                <span class="reviewer-name">${data.name}</span>
                                <span class="review-date">${dateStr}</span>
                            </div>
                            <div class="review-stars">${starsHTML}</div>
                            <div class="review-text">${data.text}</div>
                        </div>
                      `;
                      container.innerHTML += html;
                  });

                  // Update rata-rata rating di Header Modal
                  const avg = (totalRating / count).toFixed(1);
                  document.getElementById('detailAvgRating').innerHTML = `${avg} <i class="fas fa-star" style="font-size:0.7rem; color:var(--brand-orange)"></i>`;

              })
              .catch((error) => {
                  console.log("Error getting reviews:", error);
                  container.innerHTML = "<div style='color:#e66042; text-align:center;'>Gagal memuat ulasan.</div>";
              });
        }

        // --- INSTALL ANIMATION & INCREMENT COUNT ---
        function startInstall(btn, url, appId) {
            if(url === '#') { 
                closeDetail();
                switchPage('offers', document.getElementById('nav-offers'));
                return;
            }
            
            let currentCount = getDownloads(appId);
            let newCount = currentCount + 1;
            
            localStorage.setItem('dl_' + appId, newCount);

            const metaEl = document.getElementById('meta-' + appId);
            if(metaEl) metaEl.innerText = `AppWebiatech • ${formatCount(newCount)}`;
            
            const modalCountEl = document.getElementById('detailDownloadCount');
            if(modalCountEl) modalCountEl.innerText = newCount + '+';

            btn.classList.add('loading');
            btn.innerText = "";
            setTimeout(() => {
                btn.classList.remove('loading');
                btn.classList.add('open');
                btn.innerText = "Buka";
                window.location.href = url;
            }, 2000);
        }

        // --- PROMO CODE SYSTEM ---
        function checkPromo() {
            const code = document.getElementById('promoInput').value.toUpperCase();
            const msg = document.getElementById('promoMsg');
            const SECRET = "APPGRATIS211@#$&&9381282838838882837788818288838821983838388383828282828282883828282828282883379293838288299999999993838388282818199293938938392929298373838288181818677777777888483883828818181818188181828828373838383883838383848484874737372882828282882828282828288282828377447747484838282828929292982838383828828282818818182"; 

            if (code === SECRET) {
                msg.innerHTML = '<span style="color:var(--brand-green)"><i class="fas fa-check"></i> Kode Valid!</span>';
                document.getElementById('hiddenDownload').classList.remove('hidden');
                showToast("Selamat! Kode berhasil ditukarkan.");
            } else {
                msg.innerHTML = '<span style="color:var(--brand-orange)">Kode tidak ditemukan.</span>';
                showToast("Kode salah, coba lagi.");
            }
        }
    </script>
</body>
</html>
